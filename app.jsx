const {useState,useEffect}=React; const API='http://localhost:5100/api'; function useAuth(){ const [token,setToken]=useState(localStorage.getItem('edu_token')||''); function save(t){ setToken(t); localStorage.setItem('edu_token',t);} function logout(){ setToken(''); localStorage.removeItem('edu_token'); } return {token,save,logout}; }
function Login({onLogin}){ const [u,setU]=useState(''); const [p,setP]=useState(''); async function s(e){ e.preventDefault(); try{ const r=await axios.post(API+'/auth/login',{username:u,password:p}); onLogin(r.data.token);}catch(e){alert(e.response?.data?.error||'Error')} } return <form className='card' onSubmit={s}><h3>Login</h3><input value={u} onChange={e=>setU(e.target.value)} placeholder='username'/><input type='password' value={p} onChange={e=>setP(e.target.value)} placeholder='password'/><div><button>Login</button></div></form>; }
function Register({onLogin}){ const [u,setU]=useState(''); const [p,setP]=useState(''); async function s(e){ e.preventDefault(); try{ const r=await axios.post(API+'/auth/register',{username:u,password:p}); onLogin(r.data.token);}catch(e){alert(e.response?.data?.error||'Error')} } return <form className='card' onSubmit={s}><h3>Register</h3><input value={u} onChange={e=>setU(e.target.value)} placeholder='username'/><input type='password' value={p} onChange={e=>setP(e.target.value)} placeholder='password'/><div><button>Create</button></div></form>; }
function CourseForm({onCreate}){ const [t,setT]=useState(''); const [d,setD]=useState(''); const [inst,setInst]=useState(''); async function s(e){ e.preventDefault(); if(!t) return; onCreate({title:t,description:d,instructor:inst}); setT(''); setD(''); setInst(''); } return <form className='card' onSubmit={s}><label>Title</label><input value={t} onChange={e=>setT(e.target.value)}/><label>Description</label><input value={d} onChange={e=>setD(e.target.value)}/><label>Instructor</label><input value={inst} onChange={e=>setInst(e.target.value)}/><div><button>Add Course</button></div></form>; }
function App(){ const auth=useAuth(); const [courses,setCourses]=useState([]); useEffect(()=>{ load(); },[auth.token]); async function load(){ try{ const r=await axios.get(API+'/courses'); setCourses(r.data);}catch(e){console.error(e);} } async function createCourse(body){ await axios.post(API+'/courses', body, {headers:{Authorization:'Bearer '+auth.token}}); load(); } async function remove(id){ await axios.delete(API+'/courses/'+id, {headers:{Authorization:'Bearer '+auth.token}}); load(); } return <div><h1>EduConnectPro</h1>{!auth.token? <div style={{display:'flex',gap:12}}><Login onLogin={auth.save}/><Register onLogin={auth.save}/></div> : <div><div style={{display:'flex',justifyContent:'space-between'}}><div>Welcome</div><div><button onClick={auth.logout}>Logout</button></div></div><CourseForm onCreate={createCourse}/><div>{courses.map(c=> <div className='card' key={c.id}><h4>{c.title}</h4><p>{c.description}</p><p><small>{c.instructor}</small></p><div><button onClick={()=>remove(c.id)} style={{background:'#ef4444'}}>Delete</button></div></div>)}</div></div>}</div>; } ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
